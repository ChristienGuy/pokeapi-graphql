version: '3'
services:
  # Database image
  mongodb:
    image: mongo
    ports:
      - "27017:27017"

  # Own code webserver
  graphql-api:
    build: 
      context: .
    environment: 
      - PORT=80
    ports:
      - "80:80"
    links:
      - mongodb
    command: ["sh", "./wait-for-it.sh", "mongodb:27017", "--", "./run.sh"]

  # image specifically for seeding the database
  mongo-seed:
    build: ./mongo-seed
    links:
      - mongodb